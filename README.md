# letters

Дедлайн --- конец курса. Но не забывайте, что будет еще одна домашка.

# Дано:

Здоровенная картинка. На ней большое количество букв, которые могут быть перевернуты. 
Картинка для каждого студента генерируется персонально. И через небольшое количество времени после создания репозитория будет добавлена в репозиторий ботом.

### Шрифты
Список шрифтов, которые могут попасться. Все эти шрифты есть в колабе. В одной картинке все буквы нарисованы одним типом шрифта.
```python
font_list = [ 
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans-Bold.ttf',
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSansMono-Bold.ttf',
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSansMono.ttf',
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf',
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSerif-Italic.ttf',
    '/usr/local/lib/python3.9/dist-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSerif.ttf',
 ]
```

Размер шрифта для каждой буквы рандомный, от 100 до 200.

Всего на картинке 10к букв. 

**Нужно: посчитать количество раз, которое встречается каждая буква и закоммитить результат в файл** `letters.csv`

```
Для отправки ответа, вам необходимо сформировать файл (`letters.csv`) в следующем формате:
A,11  
C,6  
B,10  
...
```

Так же нужно прикрепить ноутбук, в котором вы решали эту задачу. 

**Оценка работы:**

Как и в предыдущих домашках оценку вы получаете автоматически. Если вы правильно посчитали количество всех букв, то вы получаете 4 балла. Если есть ошибка классификации хотя бы для одной буквы, вы получаете 0 баллов.

# С чего начать?

Декомпозируйте задачу. Вам нужно будет:
* предобработать исходное изображение, выделить из него буквы отдельно
* разметить или сгенерировать обучающий датасет
* обучить модель на вашем датасете
* протестировать на тестовой выборке и подготовить сабмишн

### Предобработка

* Есть ли какой-то паттерн, какой угол наклона у разных букв? Попробуйте вывести формулу наклона для всех букв для начала для первой строки, для первого столбца, потом для второго и найдите закономерность.

### Поиск границ буквы

Обратите внимание, что размер картинки кратен количеству букв и по вертикали, и по горизонтали. Заметив это, можно выделить область, где гаранитрованно есть одна и только одна буква. В рамках этой области смещение буквы будет рандомным. Угол наклона буквы не рандомный, см предыдущий пункт.

Еще в каждой области буквы может быть от 10 до 40 кружочков -- это зашумление, чтобы усложнить задачку

### Разметка

Нет разметки для датасета. Реально ли разметить все буквы вручную? 

* Сколько букв вы сможете разметить? Убедитесь, все ли буквы алфавита были в вашей разметке? Обычно чем больше, тем лучше. Но чем больше размечаете руками, тем больше вероятность ошибки. 
* Cбалансированы ли классы? Как можно бороться с дисбалансом?
* Чем буква `W` отличается от `M`? Может быть, есть еще похожие буквы?
* Какие еще буквы можно перепутать?
* Вообще говоря, вы знаете, каким шрифтом были написаны буквы. Возможно, вместо ручной разметки, вы можете кодом сгенерировать обучающий датасет? (да, можете!). И сами его аугментировать дорисовав кружочки. Полезные ссылки:
* Как наложить кружочки с прозрачностью https://stackoverflow.com/questions/43618910/pil-drawing-a-semi-transparent-square-overlay-on-image#43620169


### Обучение модели

Обучите классификатор на свертках

* Обратите внимание, что размер шрифта может быть тоже разным (от 100 до 200)
* Какие аугментации вы захотите использовать?
* Какие аугментации не стоит использовать?
* Имеет ли смысл использовать предобученную модель? (скорее всего, нет)
* Как вы можете отследить переобучение?

PS Именно эту версию задачки не решали раньше. В прошлом году в чем-то задачка была посложнее, а в чем-то попроще. Но с большой вероятностью, эту задачу возможно решить)
